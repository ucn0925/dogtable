<div class="container mt-4">
  <div class="row-justify-content-center">
    <div class="col-md-8 col-lg-6">

      <!-- 編集タイトル -->
      <h2 class="text-center mb-4">投稿を編集する</h2>

      <%= form_with(model: [@shop, @post], local: true) do |f| %>

        <div class="card shadow-sm p-4 mb-4">

          <!-- 入力フォーム -->  
          <%= render "form", post: @post, shop: @shop, f: f %>

          <!-- 投稿済み画像 -->
          <% if @post.images.attached? %>
            <div class="card p-3 shadow-sm mb-4">
              <h5 class="mb-3">投稿済みの画像</h3>

              <div class="row g-3">
                <% @post.images.each do |image| %>
                  <div class="col-6 col-md-4">
                    <div class="position-relative">

                      <%= image_tag image.variant(resize_to_limit: [200, 200]),
                            class: "img-fluid rounded" %>

                      <%= link_to(
                            destroy_image_shop_post_path(@post.shop, @post, image_id: image.id),
                            {
                              data: { 
                                turbo_method: :delete, 
                                turbo_confirm: "この画像を削除しますか？"
                              },
                              class: "btn btn-danger btn-sm rounded-circle d-flex align-items-center justify-content-center position-absolute",
                              style: "top: -8px; right: -8px; width: 26px; height: 26px; padding: 0;"
                            }
                          ) do %>
                        ×
                      <% end %>                  

                    </div>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>

          <!-- ボタン専用フォーム -->
          <div class="mt-3">
            <%= f.submit "更新する", class: "btn btn-primary w-100" %>
          </div>

        </div>
      
      <% end %>

      <!-- 戻るリンク -->
      <div class="text-center">
        <%= link_to "戻る", shop_path(@shop), class: "btn btn-outline-secondary" %>
      </div>

    </div>
  </div>
</div>